<script>

let isPlaying = false;

// ðŸŽ¯ Random vá»‹ trÃ­ viÃªn Ä‘áº¡n 1 láº§n duy nháº¥t khi load
let bulletPosition = Math.floor(Math.random() * 6);
let currentChamber = 0;

// ðŸ”Š Ã‚m thanh
const bangSound = new Audio("./bang.mp3");
const clickSound = new Audio("./click.mp3");

bangSound.preload = "auto";
clickSound.preload = "auto";

// Unlock audio cho browser
document.addEventListener("click", function unlock() {
    bangSound.play().then(() => bangSound.pause()).catch(()=>{});
    clickSound.play().then(() => clickSound.pause()).catch(()=>{});
    document.removeEventListener("click", unlock);
});

document.getElementById("triggerBtn").addEventListener("click", pullTrigger);

function pullTrigger(){

  if(isPlaying) return;
  isPlaying = true;

  const result = document.getElementById("result");
  const btn = document.getElementById("triggerBtn");

  btn.disabled = true;

  setTimeout(()=>{

    if(currentChamber === bulletPosition){

      // ðŸ’¥ TRÃšNG Äáº N
      result.innerText = "ðŸ’¥ BANG!";
      result.style.color = "red";
      document.body.style.background = "#550000";

      bangSound.currentTime = 0;
      bangSound.play().catch(()=>{});

      // ðŸ”„ Reset vá» sÃºng má»›i
      bulletPosition = Math.floor(Math.random() * 6);
      currentChamber = 0;

    } else {

      // ðŸ˜®â€ðŸ’¨ Há»¤T
      result.innerText = "ðŸ˜®â€ðŸ’¨ Click...";
      result.style.color = "lightgreen";

      clickSound.currentTime = 0;
      clickSound.play().catch(()=>{});

      currentChamber++; // quay sang nÃ²ng tiáº¿p theo
    }

    setTimeout(()=>{
      document.body.style.background = "#111";
      result.innerText = "";
      btn.disabled = false;
      isPlaying = false;
    },1200);

  },300);
}

</script>
